<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="797.36371"
   height="1660.0668"
   id="svg2"
   version="1.1"
   inkscape:version="0.48.2 r9819"
   sodipodi:docname="potential_vatticlip_problem.svg">
  <defs
     id="defs4" />
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="1"
     inkscape:cx="244.14921"
     inkscape:cy="384.36377"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="false"
     inkscape:object-paths="false"
     inkscape:window-width="1920"
     inkscape:window-height="1018"
     inkscape:window-x="-8"
     inkscape:window-y="-8"
     inkscape:window-maximized="1"
     fit-margin-top="20"
     fit-margin-left="20"
     fit-margin-right="20"
     fit-margin-bottom="20" />
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(18.773835,14.869556)">
    <g
       id="g3761"
       transform="translate(0,50.507627)">
      <path
         sodipodi:nodetypes="cccccccc"
         inkscape:connector-curvature="0"
         id="path2987"
         d="M 151.96804,301.94227 27.682332,119.79941 161.96805,19.799412 l 100,82.857138 -110.00001,199.28572 25.39224,-165.66474 -58.24938,17.80759 z"
         style="fill:#8dc1d6;fill-opacity:1;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" />
      <text
         sodipodi:linespacing="125%"
         id="text3757"
         y="314.95081"
         x="146.97719"
         style="font-size:16px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#828282;fill-opacity:1;stroke:none;font-family:Sans"
         xml:space="preserve"><tspan
           y="314.95081"
           x="146.97719"
           id="tspan3759"
           sodipodi:role="line">A</tspan></text>
    </g>
    <text
       xml:space="preserve"
       style="font-size:16px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Sans"
       x="9.5964489"
       y="10.894908"
       id="text3770"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan3772"
         x="9.5964489"
         y="10.894908" /></text>
    <text
       xml:space="preserve"
       style="font-size:12px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#262626;fill-opacity:1;stroke:none;font-family:Sans;-inkscape-font-specification:Sans"
       x="5.5558391"
       y="13.925365"
       id="text3774"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan3776"
         x="5.5558391"
         y="13.925365"><tspan
   style="font-style:normal;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3780">Проблема:</tspan> В точке<tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3798"> А</tspan> находятся два локальных максимума, все четыре ребра имеют одинаковые значения <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3800">bottomX</tspan>.</tspan><tspan
         sodipodi:role="line"
         x="5.5558391"
         y="28.925365"
         id="tspan3778">Это в случайном порядке приведет к неправильной сортировке ребер в списке <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3796">AEL</tspan>.</tspan><tspan
         sodipodi:role="line"
         x="5.5558391"
         y="43.925365"
         id="tspan3786"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"><tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3792">Решение:</tspan> в процессе добавления ребер в список <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3794">AEL</tspan> принимать <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3806">dx</tspan> как вторичный фактор сортировки для ребер</tspan><tspan
         sodipodi:role="line"
         x="5.5558391"
         y="58.961433"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3788">с одинаковым <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3802">bottomX</tspan>. Данная мера может касаться и процедур подсчета like/unlike ребер <tspan
   style="font-style:oblique;-inkscape-font-specification:Sans Oblique"
   id="tspan3804">левее</tspan> определенного ребра.</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:12px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#262626;fill-opacity:1;stroke:none;font-family:Sans;-inkscape-font-specification:Sans"
       x="10.592773"
       y="387.97891"
       id="text3774-1"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="10.592773"
         y="387.97891"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3788-5"><tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3083">UPD:</tspan> все хорошо когда локальные максимумы принадлежат одному типу полигона (subject или clip).Процессинг пересечений</tspan><tspan
         sodipodi:role="line"
         x="10.592773"
         y="402.97891"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3079">разрешает все проблемы с неверной пространственной сортировкой. Случай с принадлежностью ребер к разным типам</tspan><tspan
         sodipodi:role="line"
         x="10.592773"
         y="417.97891"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3081">полигонов пока не проверен.</tspan></text>
    <g
       id="g32"
       transform="matrix(0.5,0,0,0.5,22,498)">
      <path
         d="M -10,-10 600,0 610,610 0,600 -10,-10"
         id="path33"
         inkscape:connector-curvature="0"
         style="fill:#ffdd77;fill-opacity:0.9;stroke:#777777;stroke-width:1;stroke-opacity:0.7" />
      <path
         d="M 50,200 300,500 150,200 175,210 300,500 200,190 250,230 300,500 290,240 320,280 300,500 600,200 250,50 50,200"
         id="path35"
         inkscape:connector-curvature="0"
         style="fill:#77ddff;fill-opacity:0.9;stroke:#777777;stroke-width:1;stroke-opacity:0.7" />
    </g>
    <text
       xml:space="preserve"
       style="font-size:12px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#262626;fill-opacity:1;stroke:none;font-family:Sans;-inkscape-font-specification:Sans"
       x="9.2802734"
       y="442.53796"
       id="text3774-1-4"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="9.2802734"
         y="442.53796"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3081-4"><tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3083-8">UPD:</tspan> примечательно что алгоритм действительно самостоятельно &quot;разбирается&quot; с обозначенной в начале документа ситуацией:</tspan><tspan
         sodipodi:role="line"
         x="9.2802734"
         y="457.53796"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3091">сортировка происходит на стадии обработки пересечений. И даже случай как на следующей картинке - не проблема.</tspan><tspan
         sodipodi:role="line"
         x="9.2802734"
         y="472.53796"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3101">Единственное что смущает - избыточность операций при обработке пересечений в случае совпадающих минимумов. Быстрее</tspan><tspan
         sodipodi:role="line"
         x="9.2802734"
         y="487.53796"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3099">будет работать сортировка ребер на стадии добавления новых минимумов.</tspan></text>
    <g
       transform="matrix(0.5,0,0,0.5,30.020539,849.64093)"
       id="g41">
      <path
         d="M -10,-10 600,0 610,610 0,600 -10,-10"
         id="path43"
         inkscape:connector-curvature="0"
         style="fill:#77ddff;fill-opacity:0.9;stroke:#777777;stroke-width:1;stroke-opacity:0.7" />
      <path
         d="m 330,500 -5,-50 25,-50 100,-100 -150,-50 -150,50 200,100 -25,50 5,50"
         id="path45"
         inkscape:connector-curvature="0"
         style="fill:#ffdd77;fill-opacity:0.9;stroke:#000000;stroke-width:1;stroke-opacity:1" />
    </g>
    <text
       xml:space="preserve"
       style="font-size:12px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#262626;fill-opacity:1;stroke:none;font-family:Sans;-inkscape-font-specification:Sans"
       x="12.908203"
       y="822.99695"
       id="text3774-1-4-1"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="12.908203"
         y="822.99695"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3099-4"><tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3083-8-4">UPD:</tspan> обрабатывается нормально даже случай с совпадающими ребрами (одного типа subject/clip, разные типы пока не проверены).</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:12px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#262626;fill-opacity:1;stroke:none;font-family:Sans;-inkscape-font-specification:Sans"
       x="3.7530975"
       y="1208.0258"
       id="text3774-1-4-1-0"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="3.7530975"
         y="1208.0258"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3099-4-9"><tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3083-8-4-4">UPD:</tspan><tspan
   style="font-style:oblique;-inkscape-font-specification:Sans Oblique"
   id="tspan3056"> &quot;алмаз&quot;</tspan>. Проблема с локальным минимумом (точка схода вверху). В момент начала процессинга <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3058">Active Edge List</tspan> список</tspan><tspan
         sodipodi:role="line"
         x="3.7530975"
         y="1223.0258"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3063">содержит четыре корректно отсортированных ребра <tspan
   style="fill:#666666;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3060">A</tspan>, <tspan
   style="fill:#008000;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3064">B</tspan>, <tspan
   style="fill:#008000;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3066">C</tspan> и <tspan
   style="fill:#666666;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3062">D</tspan>. Ребра <tspan
   style="fill:#666666;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3070">A</tspan> и <tspan
   style="fill:#666666;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3074">D</tspan> - <tspan
   style="font-style:oblique;-inkscape-font-specification:Sans Oblique"
   id="tspan3110">non-contributing</tspan>, ребра <tspan
   style="fill:#008000;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3076">B</tspan> и <tspan
   style="fill:#008000;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3078">C</tspan> - <tspan
   style="font-style:oblique;-inkscape-font-specification:Sans Oblique"
   id="tspan3112">contributing</tspan>.</tspan><tspan
         sodipodi:role="line"
         x="3.7530975"
         y="1238.0258"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3084">Первым на обработку поступает ребро <tspan
   style="fill:#666666;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3087">A</tspan>. По текущей логике оно будет классифицировано как <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3114">Local Minima</tspan> потому что</tspan><tspan
         sodipodi:role="line"
         x="3.7530975"
         y="1253.0258"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3088"><tspan
   style="fill:#666666;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3082">A</tspan>.successor == null, в следствие чего оно будет удалено из списка <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3116">AEL</tspan>, так же как и следующее в списке ребро <tspan
   style="fill:#008000;font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3118">B</tspan>. Это нарушит</tspan><tspan
         sodipodi:role="line"
         x="3.7530975"
         y="1268.0258"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3090">дальнейшую логику алгоритма.</tspan><tspan
         sodipodi:role="line"
         x="3.7530975"
         y="1283.0258"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3092"><tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3122">Предлагаемое решение:</tspan> если рассматриваемое ребро - <tspan
   style="font-style:oblique;-inkscape-font-specification:Sans Oblique"
   id="tspan3124">non-contributing</tspan>, просто удаляем его из списка <tspan
   style="font-weight:bold;-inkscape-font-specification:Sans Bold"
   id="tspan3126">AEL</tspan> и переходим к</tspan><tspan
         sodipodi:role="line"
         x="3.7530975"
         y="1298.0258"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3094">рассмотрению следюущего ребра. Если же оно <tspan
   style="font-style:oblique;-inkscape-font-specification:Sans Oblique"
   id="tspan3128">contributing, </tspan>действуем по ранее утвержденной схеме: замыкаем полигон и удаляем </tspan><tspan
         sodipodi:role="line"
         x="3.7530975"
         y="1313.0258"
         style="font-style:normal;font-weight:normal;-inkscape-font-specification:Sans"
         id="tspan3096">два ребра - текущее и следующее.</tspan></text>
    <g
       id="g3043">
      <g
         transform="translate(1.726165,1324.6972)"
         id="g47">
        <path
           style="fill:#ffdd77;stroke:#777777;stroke-width:1;stroke-opacity:0.7"
           inkscape:connector-curvature="0"
           id="path49"
           d="M 100,0 200,100 100,300 0,100 100,0" />
        <path
           style="fill:#77ddff;stroke:#777777;stroke-width:1;stroke-opacity:0.7"
           inkscape:connector-curvature="0"
           id="path51"
           d="M 100,0 150,100 100,300 50,100 100,0" />
      </g>
      <text
         sodipodi:linespacing="125%"
         id="text3065"
         y="1372.4578"
         x="41.53603"
         style="font-size:16px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Sans;-inkscape-font-specification:Sans"
         xml:space="preserve"><tspan
           style="fill:#808080"
           y="1372.4578"
           x="41.53603"
           id="tspan3067"
           sodipodi:role="line">A</tspan></text>
      <text
         sodipodi:linespacing="125%"
         id="text3069"
         y="1385.9576"
         x="80.036026"
         style="font-size:12px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Sans"
         xml:space="preserve"><tspan
           style="fill:#008000"
           y="1385.9576"
           x="80.036026"
           id="tspan3071"
           sodipodi:role="line">B</tspan></text>
      <text
         sodipodi:linespacing="125%"
         id="text3073"
         y="1386.9576"
         x="118.03603"
         style="font-size:12px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Sans"
         xml:space="preserve"><tspan
           style="fill:#008000"
           y="1386.9576"
           x="118.03603"
           id="tspan3075"
           sodipodi:role="line">C</tspan></text>
      <text
         sodipodi:linespacing="125%"
         id="text3077"
         y="1361.9576"
         x="147.03603"
         style="font-size:12px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#666666;fill-opacity:1;stroke:none;font-family:Sans"
         xml:space="preserve"><tspan
           y="1361.9576"
           x="147.03603"
           id="tspan3080"
           sodipodi:role="line">D</tspan></text>
    </g>
  </g>
</svg>
